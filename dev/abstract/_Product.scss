@use "./Typo";

/**
    CLASSE COMMUNE AU MINIATURE EN FORME DE "CARTE" OU DE "LIGNE" //////////////

    Par cons√©quent d√©finir √† partir d'ici toutes les caract√©ritiques communes
    aux articles : couleur, fontes, etc. Les diff√©rences se g√©rant dans des
    fichiers sp√©cifiques.
**/

// Classe √† appliquer aux "PRODUCT" (article)
.abstract-Product {
	// Les variables par d√©faut --------------------------------------------
	--product__code__color: var(--global__foreground-color);
	--product__rga__color: var(--label__color);
	--product__libelle__color: var(--global__foreground-color);
	--product__price__color: var(--global__foreground-color);
	--product__border-color: var(--colormap__product-color); // Voir fichier "utils/colormap.scss"
	--product__cat-color: var(--global__foreground-color);
	--product__marque__width: 12rem;
	--product__marque__height: 5rem;

	/** 
		LE LOGO DE LA MARQUE -------------------------------------------
		Car ils peuvent √™tre sur fond noir ou blanc
	**/
	// prettier-ignore
	@media (prefers-color-scheme: light) { & { --product__marque__logo: var(--marque__logo-color__url);}}
	// prettier-ignore
	@media (prefers-color-scheme: dark) { & { --product__marque__logo: var(--marque__logo-white__url); } }

	// L'ast√©rix pour √™tre compatible avec les miniatures et les fiches produits
	*[class*="product-marque"] {
		position: relative;
		text-align: unset;
		margin-bottom: 2rem;
		width: var(--product__marque__width);
		height: var(--product__marque__height);
		padding: 0;
		border: none; // Pour les liens !
		//
		&::before {
			content: "";
			position: absolute;
			width: 100%;
			height: 100%;
			background: var(--product__marque__logo);
			background-size: contain;
			background-position: left center;
			background-repeat: no-repeat;
		}
	}

	/**
		L'IMAGE PRODUIT --------------------------------------------------
		".image img" pour les thumbnails
		".left picture "pour les inlines
	**/
	// prettier-ignore
	.image, .left {
		// prettier-ignore
		img, picture { mix-blend-mode: multiply; }

		box-shadow: inset 0 0 5rem #00000022;
		background: #fff;
		border-radius: calc(var(--global__UI__border-radius--card) * 0.25);
		width: 100%;
		height: auto;
		aspect-ratio: 1 / 1;
		display: grid;
		place-content: center;
		margin: 0;
		padding: 1rem;
	}

	/**
		LE CODE ARTICLE ----------------------------------------------------
	**/
	.product-code {
		grid-area: code;
		//
		position: relative;
		font-family: var(--global__font-family__text) !important;
		font-size: var(--global__font-size__sm) !important;
		font-weight: var(--global__font-weight__light) !important;
		color: var(--product__code__color) !important;
		padding: 0rem 0;

		// Le soulignement
		&::before {
			content: "";
			position: absolute;
			width: 3em;
			height: 0.15em;
			background-color: var(--product__border-color, #666);
			bottom: -0.5rem;
		}
	}

	/**
		LE RGA ARTICLE ----------------------------------------------------
		Ing√©nieusement mis dans le code article üòÖ
	**/
	.product-rga {
		grid-area: rga;
		//
		color: var(--product__rga__color) !important;
		font-size: var(--global__font-size__xs) !important;
	}

	/**
		LA DESIGNATION ARTICLE ---------------------------------------------
	**/
	.product-libelle {
		grid-area: libelle;
		//
		color: var(--product__libelle__color);
		font-family: var(--global__font-family__title);
		font-size: var(--global__font-size__md);
		font-weight: var(--global__font-weight__bold);
		text-transform: uppercase;
		line-height: 1.15em;
	}

	/**
		LA DESCRIPTION ARTICLE -----------------------------------------------
		// Uniquement fiche article
	**/
	.product-description {
		grid-area: description;
		//
		font-family: var(--global__font-family__text);
		font-size: var(--global__font-size__sm);
		font-weight: var(--global__font-weight__light);
		line-height: 2em;

		// prettier-ignore
		@media (prefers-color-scheme: light) { & { color: var(--global__color__grey75); } }
		// prettier-ignore
		@media (prefers-color-scheme: dark) { & { color: var(--global__color__grey25); } }
	}

	/**
		LA CAT√âGORIE DE L'ARME ARTICLE ------------------------------------------
		// Uniquement fiche article
	**/
	.product-cat {
		grid-area: cat;
		//
		// prettier-ignore
		&.cat-B{ --product__cat-color: var(--global__color__cat-B );}
		// prettier-ignore
		&.cat-C{ --product__cat-color: var(--global__color__cat-C );}
		// prettier-ignore
		&.cat-D{ --product__cat-color: var(--global__color__cat-D );}
		//
		color: white;
		background-color: var(--product__cat-color);
		border-radius: calc(var(--global__UI__border-radius--card) * 0.25);

		font-family: var(--global__font-family__title);
		font-weight: var(--global__font-weight__bold);
		font-size: 4rem;
		padding: 1.3rem 0.2em 1.4rem 1.4rem;

		&:before {
			content: "Cat√©gorie ";
			font-family: var(--global__font-family__text);
			font-weight: var(--global__font-weight__bold);
			font-size: 0.6rem;
			transform: translate(-3px, 17px) rotate(-90deg);
			transform-origin: left center;
			position: absolute;
		}
	}

	/**
		LA DISPONIBILT√â  -------------------------------------------------
		// D√©l√©gu√© sur le prix public
	**/
	.product-stock {
		grid-area: stock;
		display: none;
	}
	&.stock-danger {
		--product__stock__opacity: 0.4; // L'opacit√© de stock
		--product__stock__content: "\f00d"; //  ‚ùå  l'icone accompagnant le label
		--product__stock__color: var(--global__color__danger); // La couleur de l'icone
	}
	&.stock-success {
		--product__stock__opacity: 0.8;
		--product__stock__content: "\f00c"; //  ‚úî
		--product__stock__color: var(--global__color__success);
	}

	/**
		LES PRIX  -----------------------------------------------------
		// Public et pro
	**/
	.product-prix {
		// Fait passer le label apr√®s le prix
		display: flex;
		flex-direction: column-reverse;
		flex-wrap: nowrap;
		align-items: flex-start;

		// Affiche la couleur du prix selon la dispo
		opacity: var(--product__stock__opacity);
		color: var(--product__price__color);

		// Sur√©crit les classes Equation
		padding: 0 !important;
		margin: 0 0 -0.5rem 0 !important;

		// Effet du r√©duction du prix -------------------------------------
		transform-origin: left center;
		//
		// prettier-ignore
		&[data-toggle="prix-tarif"] { grid-area: prix_tarif ;}
		// prettier-ignore
		&[data-toggle="prix-public"] { display: flex !important ; grid-area: prix_public ; }
		// Sur√©crit la masquage du prix qui utilise IMPORTANT dans le fichier "global.scss"

		// Le label des prix -------------------------------------------
		.desc-label {
			font-size: 0; // R√©duction du texte d'orgine

			&:after {
				// D√©finition du texte de remplacement
				content: "PRIX";
				font-size: var(--global__font-size__xs);
				line-height: 1rem;
			}
		}
		// D√©finition du label de remplacement pour le prix pro
		&[data-toggle="prix-tarif"] .desc-label:after {
			content: "Tarif HT";
		}
		// D√©finition de l'icone de stock et sa couleur, juste  avant le label de remplacement
		&[data-toggle="prix-public"] .desc-label:before {
			content: var(--product__stock__content);
			color: var(--product__stock__color);
			font-size: var(--global__font-size__sm);
			font-family: FontAwesome;
			line-height: 0.7rem;
			position: absolute;
		}
		// D√©finition du label de remplacement pour le prix public
		&[data-toggle="prix-public"] .desc-label:after {
			content: "Prix vente conseill√©";
			margin-left: 1.5rem;
		}
		// Le prix par lui-m√™me ------------------------------------------
		.desc-value {
			color: var(--product-price__color) !important ;
			font-size: var(--global__font-size__md);
			font-weight: var(--global__font-weight__bold);
			margin-bottom: 0.33em;

			&.lead {
				margin-bottom: -0.25rem;
				min-height: initial;
			}
		}
	}
}

/**
	Permet de dissocier les Thumbnails de la fiche article.
**/
.abstract-Product--card {
	border: none !important ;
	border-radius: var(--global__UI__border-radius--card);
	background-color: var(--global__background-color);
	transition: var(--global__transition--all);
	padding: 2rem 2rem 2.5rem 2rem;
	margin: 0;
	box-shadow: none;
	@extend .abstract-Product;

	// Les variables au survol ---------------------------------------------
	&:hover {
		//--product-price__color: white;
		--product__code__color: white;
		--product__rga__color: white;
		--product__libelle__color: white;
		--product__border-color: white;
		--product__button__color: white;
		--product__icon__color: var(--colormap__product-color);
		--product__ribbon__color: black;

		background-color: var(--colormap__product-color);
		box-shadow: none;
	}
	&.stock-danger:hover,
	&.stock-success:hover {
		--product__stock__opacity: 1;
	}
}

/**
	Ajout d'un bloc de couleur utlisant le BEFORE et l'AFTER de classe √©tendue.
	Correspond au "statut-XXXX" (avec faute) envoy√© par Equapro depuis Equation.
**/
.abstract-Product--Status {
	--product__status__font-size: var(--global__font-size__sm);
	--product__status__inset: 0 auto auto 0;
	//
	// Taille et position en commun
	&.statut-PRECO::after,
	&.statut-PRECO::before,
	&.statut-NOUVEAU::after,
	&.statut-NOUVEAU::before {
		content: "";
		color: transparent;
		position: absolute;
		inset: var(--product__status__inset);
		//
		display: grid;
		place-content: center;
		font-size: var(--product__status__font-size);
		font-weight: var(--global__font-weight__bold);
		letter-spacing: -0.05rem;
		padding: 0.75em 1.5em;
		z-index: 1;
	}
	// D√©finit la forme pour tous -----------------------------------
	&.statut-NOUVEAU::after,
	&.statut-PRECO::after {
		clip-path: polygon(0% 10%, 100% 0%, 90% 100%, 5% 95%);
	}
	// L'ombre, annule le clip-path √† cause du blur ----------------
	&.statut-NOUVEAU::before,
	&.statut-PRECO::before {
		clip-path: unset;
		background: linear-gradient(90deg, #000000cc, #00000000);
		transform: scale(1.1, 0.85) rotate(7.5deg) translate(15px, 10px);
		filter: blur(4px);
	}
	// Pour le status NOUVEAU ---------------------------------------
	&.statut-NOUVEAU::before,
	&.statut-NOUVEAU::after {
		content: "NOUVEAU";
		// Taille dynnamique, permet que les deux soient identiques
		// Celui du dessous, l'ombre, la couleur est transparente
	}
	&.statut-NOUVEAU::after {
		color: var(--global__color__nouveau--text);
		background-color: var(--global__color__nouveau);
	}
	// Pour le status PRECO -----------------------------------------
	&.statut-PRECO::before,
	&.statut-PRECO::after {
		content: "PRECOMMANDE";
		// Taille dynnamique, permet que les deux soient identiques
		// Celui du dessous, l'ombre, la couleur est transparente
	}
	&.statut-PRECO::after {
		color: var(--global__color__preco--text);
		background-color: var(--global__color__preco);
	}
}
